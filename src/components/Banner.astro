---
interface Props {
  message?: string;
}

const { message = "#BoletínEscazú: Avances, alertas y desafíos en América Latina y el Caribe | Democracia Ambiental" } = Astro.props;
---

<banner-component data-message={message}>
  <div class="banner-container">
    <p class="banner-text">
      <span class="banner-highlight">#BoletínEscazú: </span>
      {message}
    </p>
    <button class="banner-close" aria-label="Cerrar banner">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon-close" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>
  </div>
</banner-component>

<style>
  .banner-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    height: 44px;
    font-weight: 700;
    font-size: 14px;
    color: white;
    padding: 0 16px;
    background-color: #4a3728;
    transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out, visibility 0.3s;
  }

  .banner-container.hidden {
    opacity: 0;
    transform: translateY(-100%);
    visibility: hidden;
  }

  .banner-container:not(.hidden) {
    opacity: 1;
    transform: translateY(0);
    visibility: visible;
  }

  .banner-text {
    text-align: left;
  }

  .banner-highlight {
    color: #f59e0b;
  }

  .banner-close {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 4px;
    border-radius: 4px;
    transition: background-color 0.2s;
    background: transparent;
    border: none;
    cursor: pointer;
  }

  .banner-close:hover {
    background-color: rgb(74 55 40 / 0.8);
  }

  .icon-close {
    width: 20px;
    height: 20px;
  }
</style>

<script>
  class BannerComponent extends HTMLElement {
    constructor() {
      super();
      const container = this.querySelector('.banner-container');
      const closeBtn = this.querySelector('.banner-close');

      if (localStorage.getItem('banner-closed') === 'true' && container) {
        container.classList.add('hidden');
      }

      closeBtn?.addEventListener('click', () => {
        container?.classList.add('hidden');
        localStorage.setItem('banner-closed', 'true');
      });
    }
  }

  customElements.define('banner-component', BannerComponent);
</script>
